<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
	<link rel="stylesheet" href="css/bootstrap.min.css" />
	<link rel="stylesheet" href="css/electricroommonitoring.css"/>
	<title>状态图形</title>
	
	<script  type="text/javascript" src="js/jquery-3.3.1.js"></script>
	<script  type="text/javascript" src="js/jquery.base64.js"></script>
	<script  type="text/javascript" src="js/config.js"></script>
	<script  type="text/javascript" src="js/layer/layer.js"></script>
	<script  type="text/javascript" src="js/drawmaps.js"></script>
	<script  type="text/javascript" src="js/function.js"></script>
	<style type="text/css"></style>
	
</head>
<body onload="GetBinary()">
	<div>
	<div id="head_map">
	<div class="pagecard"  style="text-align: center;font-size:20px;font-style:normal;;"><B>站示意图<!--onclick="getrealsbydataid()"--></B></div>
	<div class="rowlay" id="refrsh-binarys" style="width:100%;text-align: center;font-size:16px;vertical-align: -10%;">
		图形列表：
		<select id="txlb" style="font-size:18px;width:153px;vertical-align:-10%;">
		<option value="0">测温0</option>
	</select><span class="glyphicon glyphicon-refresh" style="margin-left:20px;margin-right: 20px;" onclick="refreshbinary()"></span>
	<!-- 起止时间:
	<input type="text" onClick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd HH:mm:ss'})"  id="kssj_history" style="width:190px;font-size:16px;height: 30px;"></input>至
	<input type="text" onClick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd HH:mm:ss'})"  id="jssj_history" style="width:190px;font-size:16px;height: 30px;" ></input>
	<input class="button" type="button" id="chaxun" value="查询" onclick="queryhistorydata()" style="font-size:16px;height: 35px;" ></input>-->
	</div>
	</div>
	
	
	<a id="mapmodule" style="color:red;position:absolute;top:40px;right:20px;text-align:right" href="javascript:void(0)" onclick="showmodule()" ></a>
	<div id="maprefresh" style="display:none" onclick="refresh()"></div><!--有告警时刷新图形显示-->
	<div id="mycanvasdiv" style="background-color:#cccccc;position: relative; text-align: center; overflow: auto;">
		<div align="center">
			<canvas id="mycanvas" align="center" width="900px" height="700px" style="background-color:#000;">
			</canvas>
		</div>
	</div>
</div>
	<script type="text/javascript">
		$(document).ready(function(){
			$.base64.utf8encode = true;
			if(sessionStorage.map_module==1){
				mapmodule.innerText="自动缩放";
			}else{
				mapmodule.innerText="原尺寸显示";
			}
			var mCanvas=document.getElementById("mycanvas");
			mCanvas.width=document.documentElement.clientWidth;
			mCanvas.height=document.documentElement.clientHeight-120;
			//GetGraphic();
			initpage();
			//refresh();
			});
		function initpage(){
			var sel_sensor=document.getElementById("txlb");
			for (var i = 0; i < sel_sensor.length; i++) {
				sel_sensor.removeChild(sel_sensor.options[0]);
				sel_sensor.remove(0);
				sel_sensor.options[0] = null;
			}
			binaries=JSON.parse(localStorage.getItem("binaries"));
			if(binaries!=null){
				for(var i=0;i<binaries.length;i++){
					var op=document.createElement("option");
					op.setAttribute("value",binaries[i].Id);
					op.innerHTML=binaries[i].Name;
					sel_sensor.appendChild(op);
				}
			}
			setSelectOption("txlb", sessionStorage.BinariesId);
			document.getElementById('txlb').addEventListener('change',function(){
				//var txlb= document.getElementById("txlb");
				sessionStorage.BinariesId=this.value;
				//alert("当前选项是:"+this.value);
				GetBinary();
             },false);
			//queryhistorydata();
		}
		function refresh(){
			var graphic = JSON.parse(sessionStorage.contents);
			drawmap(graphic);
		}
		function refreshbinary(){
			window.parent.GetBinariesByType("NodeGraphic",sessionStorage.nodeId);
		}
		function showmodule(){
			var mapmodule=document.getElementById("mapmodule");
			if(mapmodule.innerText=="原尺寸显示"){
				sessionStorage.map_module=1;
				mapmodule.innerText="自动缩放";
			}else{
				sessionStorage.map_module=0;
				mapmodule.innerText="原尺寸显示";
			}
			refresh();
		}
		window.onresize=window.onscroll=refresh;
		</script>
</body>
</html>