<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
	<link rel="stylesheet" href="css/bootstrap.min.css" />
	<link rel="stylesheet" href="css/bootstrap-treeview.min.css" />
	<link rel="stylesheet" href="css/electricroommonitoring.css"/>
	<script  type="text/javascript" src="js/jquery-3.3.1.js"></script>
	<title>机房监控</title>
	<script  type="text/javascript" src="js/jquery-3.3.1.js"></script>
	<script  type="text/javascript" src="js/config.js"></script>
	<script  type="text/javascript" src="js/layer/layer.js"></script>
	<script type="text/javascript" src="js/bootstrap.js" ></script>
	<script type="text/javascript" src="js/bootstrap-treeview.min.js" ></script>
	
	<script  type="text/javascript" src="js/function.js"></script>
</head>
<body onload="initIndex()"><!--"showusername()"<script  type="text/javascript" src="js/layer/layer.js"></script>-->
	<div class="header" id="header" style="height:80px;position:relative;overflow: auto;">
      	<div class="topbar" id="topbar" >
			<div id="app_name" style="position:relative;float:left;left:15px;font-size:30px;font-style:bold;color:white" ><i></i></div>
			<span id="img_yonghu" style="position:relative;float:left;left:40px"><!--No.2登录用户名显示/未登录-->
			<img src="res/caisetouxiang.png" width="20px" height="20px" >
			</span><!--end No.2-->
			<span id="yhname" style="position:relative;float:left;left:50px;color:white;font-size:12px;"><!--No.1登录用户名显示/未登录-->
			未登录
			</span><!--end No.1value="系统设置"-->
			
			<span id="yhout" style="position:relative;float:left;left:80px;color:white;font-size:12px;"><a href="javascript:void(0)"style="color:white;">[登录]</a></span>
			<input type="button" class="topbar-bigbutton"  value="联系我们" style="background:url(res/home.jpg) no-repeat center top;margin-top:10px;" onclick="showcontactus()"></input>
			<input type="button" class="topbar-bigbutton" value="APP下载" style="background:url(res/chilun.jpg) no-repeat center top;margin-top:10px;"onclick="showdownload()">
				
			</input>
			<!--<input type="button"  class="topbar-bigbutton" value="数据浏览" style="background:url(res/sanse.jpg) no-repeat center top;margin-top:10px;"></input>-->
			<input type="button" class="topbar-bigbutton"  value="操作指南" style="background:url(res/bar.jpg) no-repeat center top;margin-top:10px;" onclick="showhelp()"></input>
			
		</div>
		<hr style="display:none"/>
	</div><!--header-->
	<!--  内容  -->
	<div id="chuangti" style="position: relative;">
		<!--左侧站名列表 <h4 id="head_list_name" align="left"  >变电站:</h4>-->
		<div class="leftmenu" id="leftmenu" style="float:left;width:15%;overflow:auto;min-width:200px;">
			
			<div id="tree" >
			
			</div>
		</div>
		<div id="content" style="overflow: hidden;">
			
			<!-- 导航栏 -->
			<div class="navigation" style="vertical-align:center;overflow:auto">
				<div class="row-navigation" style="vertical-align:center;min-width:500px;" align="center">
						<ul class="pc-nav" >
							<li ><a href="javascript:void(0)"  onclick="inittotalpage()" >信息总览</a></li>
							<li ><a href="javascript:void(0)" onclick="initdrawing()" style="display:none" id="realstate">实时状态</a></li>
							<li ><a id="realdata"href="javascript:void(0)"  onclick="initrealdata()">实时数据</a></li>
							<li ><a id="historydata" href="javascript:void(0)" onclick="loadstations_historydata()">历史数据</a></li>
							<li ><a id="historychart" href="javascript:void(0)" onclick="loadstations_chart()">趋势图</a></li>
							<li ><a href="javascript:void(0)" onclick="loadstations_warnlog()" >告警信息</a></li>
							<!--<li ><a href="realwarning.html" target="iframe_main" >当前告警</a></li>
							target="iframe_main"-->
							<!--<li ><a href="app_download.html" target="iframe_main"  >客户端下载</a></li>
							<li ><a href="help.html" target="iframe_main" >使用指南</a></li>
							<li ><a href="ContactUs.html" target="iframe_main">联系我们</a></li>-->
						</ul>
				</div>
			</div>

			<div class="mainarea" id="mainarea" >
				<iframe  name="iframe_main" id="iframe_main" style="width:100%;height:99%" frameborder="0">
				</iframe>
			</div>
		</div>
	</div>
	
	<!--底部公司版权 -->
	<div>
		<div class="navigation" id="footer" style="height:30px;position: absolute;bottom:0px;left:0px;right:0px">	
			<div class="pc-footer" >
				<ul class="pc-footer" align="center" style="margin:0 150px;">
					<li ><a id="company_info" href="" target="_blank" ><img id="company_log" src="" width="20px" height="20px" > 保定金凯澳自动化设备有限公司</a></li>
					<!--<li ><a href="#" style="margin-left:500px" >实时告警窗口</a></li>-->
				</ul>
			</div>
		</div>
		<!--告警信息悬浮窗-->
		<div id="KeFuDiv" class="KeFuDiv" onmousedown="hidefudongdiv();" style="display:none" >
			<!--屏幕滚动设置 <div class="affiche_text" id="alert_info">
			</div>
			 <marquee id="affiche" align="middle" behavior="scroll"  direction="left" height="50" width="500" hspace="100" vspace="50" loop="-1" scrollamount="10" scrolldelay="100" onMouseOut="this.start()" onMouseOver="this.stop()" ></marquee>-->
			<div id="alert_info" style="vertical-align:center;">
			</div>
			
		</div><!--KeFuDiv endhttp://tts.baidu.com/text2audio?lan=zh&ie=UTF-8&spd=6&text=<embed height="0" width="0" src="">-->
		<div id="wrapSpk">
			<audio id="spkAudio" >
				<source src="" type="audio/wav">
				
			</audio>
			<textarea id="chatData"  style="width:300px;height:40px;display:none" onclick="spack()";>asd
			</textarea>
		</div>
		<div id="audio">
		</div>
	</div>
	<script>
		var infotreedata=[];
		var infotreeobj=new Object();
		function refreshwindow(){
		sessionStorage.framepage=document.getElementById("iframe_main").src;
		var bodyfrm = (document.compatMode.toLowerCase() == "css1compat") ? document.documentElement : document.body;
		var fdheight=document.getElementById("KeFuDiv").offsetHeight;
		var fdwidth=document.getElementById("KeFuDiv").offsetWidth;
		var main = document.getElementById("chuangti");
		var header = document.getElementById("header");
		var menu = document.getElementById("leftmenu");
		var content = document.getElementById("content");
		var footer = document.getElementById("footer");
		//获取窗口宽度
		if (window.innerWidth)
            winWidth = window.innerWidth;
        else if ((document.body) && (document.body.clientWidth))
            winWidth = document.body.clientWidth;
        //获取窗口高度
        if (window.innerHeight)
            winHeight = window.innerHeight;
        else if ((document.body) && (document.body.clientHeight))
            winHeight = document.body.clientHeight;
		//初始位置
		var top=bodyfrm.scrollTop + bodyfrm.clientHeight - fdheight-10;
		document.getElementById("KeFuDiv").style.top =top+'px';////document.getElementById("KeFuDiv").offsetHeight)-30;
		var left=bodyfrm.scrollLeft+bodyfrm.clientWidth - fdwidth;//document.getElementById("KeFuDiv").offsetWidth)-17;;
		// (winHeight - document.getElementById("KeFuDiv").offsetHeight)-30 +"px";
		document.getElementById("KeFuDiv").style.left = left+'px';//(winWidth - 
		var m = (/MSIE [67]/.test(navigator.userAgent) && (event.type=="load"))?1:2;
		if(/MSIE [567]/.test(navigator.userAgent)){
			var fwidth = main.offsetWidth;
			if(footer.style.borderWidth){
				fwidth -= m * footer.style.borderWidth.replace("px","");
			}
			footer.style.width = fwidth + "px";
		}
		var height = footer.offsetTop - main.offsetTop;
		if(main.style.borderWidth){
			height -= m * main.style.borderWidth.replace("px","");
		}	
		if(height > 0){
			main.style.height = height + "px";
			var mheight = height;
			if(menu.style.borderWidth){
				mheight -= m * menu.style.borderWidth.replace("px","");
			}
			if(mheight > 0){
				menu.style.height = mheight + "px";
			}
			mheight = height;
			if(content.style.borderWidth){
				mheight -= m * content.style.borderWidth.replace("px","");
			}
			if(mheight > 0){
				content.style.height = mheight + "px";
			}
		}
		initIndex();
	}
	window.onload=window.onresize = window.onscroll=refreshwindow;//    
	//index页面初始化
	function initIndex() {
		showusername();
		document.getElementById('app_name').innerHTML = '<i>' + jfjk_base_config.app_name + "</i>";
		document.getElementById('company_log').src = jfjk_base_config.log_src;
		document.getElementById('company_info').href = jfjk_base_config.company_url;
		sessionStorage.kssj = getCurrentDate(1) + " 00:00:00"; //"2012-09-03T08:00:00";//;
		sessionStorage.jssj = getCurrentDate(1) + " 23:59:59"; //"2012-09-05T08:00:00";//
		//sessionStorage.pageindex = 1;
		//getgraphics();
		//document.getElementById("iframe_main").src = 'page1.html';
		if(sessionStorage.islogin){	
			getNodes();
		}else{
			inittreeview();
		}
		if(sessionStorage.framepage==""){
			sessionStorage.pageindex=2;
			document.getElementById("iframe_main").src="realdata.html"
		}else{
			document.getElementById("iframe_main").src=sessionStorage.framepage;
		}
		
	}
	function inittreeview(anodes){
		//var obj=tree[1];
		//obj.nodes=(JSON.parse( node));
		//tree[1]=obj;
		var mnodes=[];
		if(anodes==null){
			mnodes=buildnode();
		}else{
			mnodes=anodes;
		}
		$('#tree').treeview({
			data: mnodes,    // 数据源
			showCheckbox: false,   //是否显示复选框
			highlightSelected: true,    //是否高亮选中
			nodeIcon:'glyphicon glyphicon-user',    //节点上的图标 glyphicon-stats
			//nodeIcon: 'glyphicon glyphicon-lock',
			emptyIcon: '',    //没有子节点的节点图标
			enableLinks : true,//必须在节点属性给出href属性
			multiSelect: false,    //多选
			searchResultColor:"black",
			//color: "", //所有节点使用的默认前景色，这个颜色会被节点数据上的Color属性覆盖.        String
			//backColor: "#000000", //所有节点使用的默认背景色，这个颜色会被节点数据上的backColor属性覆盖.     String
			//borderColor: "#000000", //边框颜色。如果不想要可见的边框，则可以设置showBorder为false。        String
			//nodeIcon: "glyphicon glyphicon-stop", //所有节点的默认图标
			//checkedIcon: "glyphicon glyphicon-check", //节点被选中时显示的图标         String
			//collapseIcon: "glyphicon glyphicon-minus", //节点被折叠时显示的图标        String
			//expandIcon: "glyphicon glyphicon-plus", //节点展开时显示的图标        String
			//emptyIcon: "glyphicon", //当节点没有子节点的时候显示的图标              String
			//enableLinks: false, //是否将节点文本呈现为超链接。前提是在每个节点基础上，必须在数据结构中提供href值。        Boolean
			//highlightSearchResults: true, //是否高亮显示被选中的节点        Boolean
			//levels: 2, //设置整棵树的层级数  Integer
			//multiSelect: false, //是否可以同时选择多个节点      Boolean
			//onhoverColor: "#F5F5F5", //光标停在节点上激活的默认背景色      String
			//selectedIcon: "glyphicon glyphicon-stop", //节点被选中时显示的图标     String
			//searchResultBackColor: "", //当节点被选中时的背景色
			//searchResultColor: "", //当节点被选中时的前景色
			//selectedBackColor: "", //当节点被选中时的背景色
			//selectedColor: "#FFFFFF", //当节点被选中时的前景色
			//showBorder: true, //是否在节点周围显示边框
			//showCheckbox: false, //是否在节点上显示复选框
			//showIcon: true, //是否显示节点图标
			//showTags: false, //是否显示每个节点右侧的标记。前提是这个标记必须在每个节点基础上提供数据结构中的值。
			//uncheckedIcon: "glyphicon glyphicon-unchecked", //未选中的复选框时显示的图标，可以与showCheckbox一起使用
			//onNodeChecked: function (event,data) {
			//	console.log("nodeId = "+data.nodeId);
			//	console.log("id = "+data.id);
			//},
			onNodeSelected: function (event, data) {
				console.log("nodeId = "+data.nodeId);
				console.log("id = "+data.id);
				console.log("name = "+data.text);
				console.log("Time = "+data.Time);
				console.log("Config = "+data.Config);
				console.log("Catalog = "+data.Catalog);
				console.log("levels = "+data.level);
				sessionStorage.name=data.text;
				//loaddata(data);
				maps=[];
				
				infotreedata=[];
				infotreeobj.id=data.id;
				infotreeobj.name=data.text;
				infotreeobj.value=data.nodes.length;
				infotreeobj.children=[];
				if(data.nodes.length>0){
					infotreeobj.children=decode(data.nodes);
				}
				infotreedata.push(infotreeobj);

				if(data.id!=sessionStorage.nodeId){
					localStorage.setItem("sensors",null);
					GetSensorsByNode(data.id,0);
					sessionStorage.nodeId=data.id;
					localStorage.t_pt = 0;
				}
			}
			/**方法
			 * checkAll(options);//选中所有树节点
			checkNode(node | nodeId, options);  //选中一个给定nodeId的树节点
			clearSearch();//清除查询结果
			collapseAll(options);//折叠所有树节点
			collapseNode(node | nodeId, options);//折叠一个给定nodeId的树节点和它的子节点
			disableAll(options);//禁用所有树节点
			disableNode(node | nodeId, options);//禁用一个给定nodeId的树节点
			enableAll(options);//激活所有树节点
			enableNode(node | nodeId, options);//激活给定nodeId的树节点
			expandAll(options);//展开所有节点
			expandNode(node | nodeId, options);//展开给定nodeId的树节点
			getCollapsed();//返回被折叠的树节点数组
			getDisabled();//返回被禁用的树节点数组
			getEnabled();//返回被激活的树节点数组  
			getExpanded();//返回被展开的树节点数组
			getNode(nodeId);//返回与给定节点id相匹配的单个节点对象。
			getParent(node | nodeId);//返回给定节点id的父节点
			getSelected();//返回被选定节点的数组。
			getSiblings(node | nodeId);//返回给定节点的兄弟节点数组
			getUnselected();//返回未选择节点的数组
			remove();//删除the tree view component.删除绑定的事件，内部附加的对象，并添加HTML元素。
			revealNode(node | nodeId, options);//显示给定的树节点，将树从节点扩展到根。
			search(pattern, options);//在树视图中搜索匹配给定字符串的节点，并在树中突出显示它们。返回匹配节点的数组。
			selectNode(node | nodeId, options);//选择一个给定的树节点
			toggleNodeChecked(node | nodeId, options);//Toggles a nodes checked state; checking if unchecked, unchecking if checked.
			toggleNodeDisabled(node | nodeId, options);//切换节点的禁用状态;
			toggleNodeExpanded(node | nodeId, options);//切换节点的展开与折叠状态
			toggleNodeSelected(node | nodeId, options);//切换节点的选择状态
			uncheckAll(options);//不选所有节点
			uncheckNode(node | nodeId, options);//不选给定nodeId的节点
			unselectNode(node | nodeId, options);//不选给定nodeId的节点
			事件：
			*nodeChecked (event, node) - 一个节点被checked.
			*nodeUnchecked (event, node) - 一个节点被unchecked.
			*nodeCollapsed (event, node) - 一个节点被折叠.
			*nodeDisabled (event, node) - 一个节点被禁用.
			*nodeEnabled (event, node) - 一个节点被启用.
			*nodeExpanded (event, node) - 一个节点被展开.
			*nodeSelected (event, node) - 一个节点被选择.
			*nodeUnselected (event, node) - 取消选择一个节点.
			*searchComplete (event, results) - 搜索完成之后触发.
			*searchCleared (event, results) - 搜索结果被清除之后触发.
			*/
		});
		$("#tree").treeview('collapseAll');//关闭展开
		if(sessionStorage.name==""||sessionStorage.name==null){
			sessionStorage.name=mnodes[0].text;//如果没有选择项，则选择第一项。
		}
		var firstNode = $("#tree").treeview('search',[sessionStorage.name+"",{ ignoreCase: false, exactMatch: false }]);//得到第一个节点//在页面尺寸变化时保持选项不变
		sessionStorage.nodeid=firstNode[0].id;//保存nodeid，用于获取指定node的sensors。
		$("#tree").treeview('expandNode',[firstNode, { levels: 2, silent: true } ]);//展开第一个节点
		//$('#tree').treeview('expandNode', [ tree[0].id, { levels: 2, silent: true } ]);
		$('#tree').treeview('selectNode', [ firstNode, { silent: true } ]);
		//$("#tree").treeview("selectNode", firstNode);//将第一个节点设置为选中状态**
		//获取指定node的sensors
		//GetSensorsByNode(sessionStorage.nodeid);
		infotreedata=[];
		infotreeobj.id=firstNode[0].id;
		infotreeobj.name=firstNode[0].text;
		infotreeobj.value=firstNode[0].nodes.length;
		infotreeobj.children=[];
		if(firstNode[0].nodes.length>0){
			infotreeobj.children=decode(firstNode[0].nodes);
			
		}
		infotreedata.push(infotreeobj);
		GetSensorsByNode(infotreeobj.id)
		setTimeout(function(){if(sessionStorage.pageindex==0){
			document.getElementById("iframe_main").src="infototal.html";
		}},3000);
	}
	function decode(adata){
		var infotree=[];
		for(var i=0;i<adata.length;i++){
			var tempobj=new Object();
			tempobj.name=adata[i].text;
			tempobj.id=adata[i].id
			tempobj.value=adata[i].nodes.length;
			tempobj.children=[];
			if(adata[i].nodes.length>0){
				tempobj.children=decode(adata[i].nodes);
			}
			infotree.push(tempobj);
			if(adata[i].level==2){
				//GetSensorsByNode(tempobj.id,1);
				setTimeout("GetSensorsByNode(tempobj.id,1)",500);
			}
		}
		return infotree;
	}

	function getNodes(){
		var url = jfjk_base_config.baseurl + "/GetNodes";
		url = encodeURI(url);
		if (sessionStorage.islogin == "true") {
			$.ajax({
				beforeSend: function(request) {
					request.setRequestHeader("_token", sessionStorage.token);
				},
				url: url,
				type: 'GET',
				dataType: 'json',
				timeout: 10000,
				error: function(jqXHR, textStatus, errorThrown) {
					inittreeview();
					layer.alert('获取系统目录列表数据失败');
					errortime++;
				},
				success: function(data, status) {
					var reg = new RegExp("(^|&)value1=([^&]*)(&|$)");
					if (status == "success") {
						errortime = 0;
						sessionStorage.islogin = true;
						if (data.Error == null) {
							var obj_nodes=[];
							var result=data.Result;
							if(!jQuery.isEmptyObject(result.Nodes)){
								obj_nodes=data.Result.Nodes;
							}
							var nodes=buildnode(obj_nodes,0);
							inittreeview(nodes);
						} else {
							layer.alert(data.Error);
							sessionStorage.islogin = ture;
						}
					}
				}
			});
		} else {
			Alert("用户未登录，您无权完成此次操作", 2000);
			inittreeview(null,0);
		}
	}
	function buildnode(data,level){
		var tree = [];
		if(data==null|| data==undefined){
			for(i=0;i<3;i++){
				var nodes=new Object();
				nodes.text="变电站"+(2-i);
				nodes.id=i;
				nodes.nodes=[];
				nodes.icon="url(res/lock.png)";
				var node='[{"text":"测温","id":'+((i+1)*10)+',"icon":"glyphicon glyphicon-user"},{"text":"局部放电","id":'+((i+1)*10+1)+'},{"text":"弧光保护","id":'+((i+1)*10+2)+'},{"text":"视频监控","id":'+((i+1)*10+3)+'},{"text":"机房监控","id":'+((i+1)*10+4)+',"nodes":[{"text":"门禁","id":543},{"text":"水浸","id":345}]}]';
				nodes.nodes=(JSON.parse( node));
				//var lnode=new Object();
				tree.push(nodes);
			}
		}else{
			for(var j=0;j<data.length;j++){
				var nodes=new Object();
				nodes.text=data[j].Value.Name;
				nodes.id=data[j].Value.Id;
				nodes.Catalog=data[j].Value.Catalog;
				nodes.Config=data[j].Value.Config;
				nodes.Time=data[j].Value.Time;
				nodes.level=level;
				var icon='glyphicon glyphicon-user';
				switch(data[j].Value.Name){
					case "石家庄":
					case "视频监控":
					icon="glyphicon glyphicon-facetime-video";//
					break;
					case "保定":
					case "测温":
						icon="glyphicon glyphicon-adjust";//glyphicon glyphicon-tree-conifer glyphicon glyphicon-bullhorn
						break;
					case "烟感":
					case "清苑":
						icon="glyphicon glyphicon-fire";//glyphicon glyphicon-leaf  glyphicon glyphicon-tint  glyphicon glyphicon-flash
						break;
					case "局部放电":
					case "安国":
						icon="glyphicon glyphicon-flash";//
						break;
					case "弧光保护":
					case "唐县":
						icon="glyphicon glyphicon-bullhorn";//
						break;
					case "机房监控":
					
						icon='glyphicon glyphicon-inbox';//
						break;
					case "门禁":
					
						icon='glyphicon glyphicon-lock';//
						break;
					case "灯光":
						icon='glyphicon glyphicon-cog';
						break;
					case "红外":
						icon='glyphicon glyphicon-signal';
						break;
					case "动力":
						icon='glyphicon glyphicon-retweet';
						break;
					case "环境":
					case "行唐":
						icon="glyphicon glyphicon-leaf";//
						break;
					case "水浸":
					case "郑州":
						icon="glyphicon glyphicon-tint";//
				}
				if(level==0){
					icon="glyphicon glyphicon-home"
				}
				nodes.icon=icon;
				if(data[j].Children.lenght!=0){
					nodes.nodes=[];
					nodes.nodes=buildnode(data[j].Children,level+1)
				}
				tree.push(nodes);
			}
		}
		return tree;
	}
	
	function showdownload(){
		document.getElementById("iframe_main").src="app_download.html"
	}
	function showhelp(){
		document.getElementById("iframe_main").src="help.html"
	}
	function showcontactus(){
		document.getElementById("iframe_main").src="ContactUs.html"
	}
	function loaddata(mdata){
		if((mdata.text==="保定")||(mdata.text=="测温")){
			document.getElementById("realstate").style.display="inline";
		}else{
			document.getElementById("realstate").style.display="none";
		}
	}
	function GetSensorsByNode(anodeid,atype){
		var url = jfjk_base_config.baseurl + "/GetSensorsByNode?nodeId="+anodeid;
		url = encodeURI(url);
		if (sessionStorage.islogin == "true") {
			$.ajax({
				beforeSend: function(request) {
					request.setRequestHeader("_token", sessionStorage.token);
				},
				url: url,
				type: 'GET',
				dataType: 'json',
				timeout: 10000,
				error: function(jqXHR, textStatus, errorThrown) {
					//inittreeview();
					layer.alert('获取系统列表数据失败');
					errortime++;
				},
				success: function(data, status) {
					//var reg = new RegExp("(^|&)value1=([^&]*)(&|$)");
					if (status == "success") {
						errortime = 0;
						if (data.Error == null) {
							var obj_sensors=[];
							var result=data.Result;
							if(!jQuery.isEmptyObject(result.Sensors)){
								//sessionStorage.setItem("sensors",JSON.stringify(buildsensor(data.Result.Sensors)));
								var sensors=buildsensor(data.Result.Sensors);//(JSON.parse(localStorage.getItem("sensors")));
								if(atype==0){
									localStorage.setItem("sensors",JSON.stringify(sensors));
								}
								//var sensors=(JSON.parse(localStorage.getItem("sensors")));
								//var localsensors=buildsensor(data.Result.Sensors);
								updatainfotree(infotreedata, anodeid,sensors.length);
								
							}
							
						} else {
							layer.alert(data.Error);
							sessionStorage.islogin = ture;
						}
					}
				}
			});
		} else {
			Alert("用户未登录，您无权完成此次操作", 2000);
			inittreeview(null,0);
		}
		if(atype==0){
			switch(sessionStorage.pageindex){
				case '0':
					document.getElementById("iframe_main").src="infototal.html";
					break;
				case '2':
					document.getElementById("iframe_main").src="realdata.html";//getrealdatabynodeid(-1);
					break;
				case '3' :
					document.getElementById("iframe_main").src="historydata.html";
					break;
				case '4':
					document.getElementById("iframe_main").src="chart.html";
					break;
				case '5':
					document.getElementById("iframe_main").src="warnlog.html";
					break;
			}
		}
	}
	function updatainfotree(treedata,tnodeid,tvalue){
		for(var j=0;j<treedata.length;j++){
			if(treedata[j].id==tnodeid){
				treedata[j].value=tvalue;
				return;
			}
			if(treedata[j].children.length>0){
				updatainfotree(treedata[j].children,tnodeid,tvalue);
			}
		}
	}
	function buildsensor(aSensors){
		if((aSensors!=undefined)&&(aSensors!=null)){
			for(var i=0;i<aSensors.length;i++){
				if((aSensors[i]!=null)&&(!jQuery.isEmptyObject(aSensors[i].Value))){
					var map=new Object();
					map.id=aSensors[i].Value.Id;
					map.Value=aSensors[i].Value;
					maps.push(map);
				}
				if((aSensors[i]!=null)&&(!jQuery.isEmptyObject(aSensors[i].Children))){
					buildsensor(aSensors[i].Children);
				}
			}
			var compare = function (obj1, obj2) {
				var val1 = obj1.Value.name;
				var val2 = obj2.Value.name;
				if (val1 < val2) {
					return -1;
				} else if (val1 > val2) {
					return 1;
				} else {
					return 0;
				}            
			} 
			return (maps.sort(compare));
		}
	}
	window.setInterval("sendbeat()",60000);
	</script>
  
</body>
</html>